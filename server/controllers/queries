//insert Data
const user_Id = uuidv4();

const { name, email, password, role } = newUser;

const SignUpQuery = `
          INSERT INTO Users (ID, email, password, name, role)
          VALUES ('${user_Id}', '${email}', '${password}', '${name}', '${role}')
        `;

sql.query(con, SignUpQuery, (err, result) => {
  if (err) {
    console.log("Database signup error: ", err);
    // Handle the error
  }
  console.log(result);
  console.log("User sign up successful");
  res.end(JSON.stringify({ MESSAGE: "User sign up successful", result }));
});
// delete token from table
const deletetokenQuery = `DELETE FROM tokensession WHERE token = '${token}'`;
sql.query(con, deletetokenQuery, (err, results) => {
  if (err) {
    console.log("error from token delete", err);
  }
  console.log("token deleted", results);
});

//for update query

let profileUpdateQuery = `UPDATE Users SET`;

if (email) {
  profileUpdateQuery += ` email = '${email}',`;
}

if (name) {
  profileUpdateQuery += ` name = '${name}',`;
}

if (phoneNumber) {
  profileUpdateQuery += ` phone = '${phoneNumber}',`;
}

if (skills) {
  profileUpdateQuery += ` skill = '${skills}',`;
}
if (profileUpdateQuery.endsWith(",")) {
  profileUpdateQuery = profileUpdateQuery.slice(0, -1);
}
profileUpdateQuery += ` WHERE ID = '${ID}'`;
sql.query(con, profileUpdateQuery, (error, result) => {
  if (error) {
    console.log("error", error);
  }
  console.log("profile updated success", result);
  res.writeHead(200, { "Content-Type": "application/json" });
  res.end(JSON.stringify({ message: "User updated successfully" }));
});
